
Pool shape : torch.Size([40000, 1, 28, 28])
Starting epig acquisition
Using original estimate_epig function
[run_image_classification_40k_epig_acq.py:150]INFO: Initial test log-likelihood: -2.6161
[run_image_classification_40k_epig_acq.py:151]INFO: Initial test Bayes log-likelihood: -2.1890
[run_image_classification_40k_epig_acq.py:152]INFO: Initial accuracy: 60.41%
We are in concat
Starting epig acquisition
Using original estimate_epig function
[run_image_classification_40k_epig_acq.py:191]INFO: Test log-likelihood at 21: -2.6835
[run_image_classification_40k_epig_acq.py:192]INFO: Test Bayes log-likelihood at 21: -2.1820
[run_image_classification_40k_epig_acq.py:193]INFO: Test accuracy: 58.26%
We are in concat
Starting epig acquisition
Using original estimate_epig function
[run_image_classification_40k_epig_acq.py:191]INFO: Test log-likelihood at 22: -2.4098
[run_image_classification_40k_epig_acq.py:192]INFO: Test Bayes log-likelihood at 22: -2.1629
[run_image_classification_40k_epig_acq.py:193]INFO: Test accuracy: 60.46%
We are in concat
[run_image_classification_40k_epig_acq.py:191]INFO: Test log-likelihood at 23: -2.6852
[run_image_classification_40k_epig_acq.py:192]INFO: Test Bayes log-likelihood at 23: -2.1457
[run_image_classification_40k_epig_acq.py:193]INFO: Test accuracy: 58.57%
Starting epig acquisition
Using original estimate_epig function
We are in concat
Starting epig acquisition
Using original estimate_epig function
[run_image_classification_40k_epig_acq.py:191]INFO: Test log-likelihood at 24: -2.5285
[run_image_classification_40k_epig_acq.py:192]INFO: Test Bayes log-likelihood at 24: -2.1471
[run_image_classification_40k_epig_acq.py:193]INFO: Test accuracy: 63.51%
We are in concat
[run_image_classification_40k_epig_acq.py:191]INFO: Test log-likelihood at 25: -3.0968
[run_image_classification_40k_epig_acq.py:192]INFO: Test Bayes log-likelihood at 25: -2.1370
[run_image_classification_40k_epig_acq.py:193]INFO: Test accuracy: 60.23%
Starting epig acquisition
Using original estimate_epig function
We are in concat
Traceback (most recent call last):
  File "/dss/dsshome1/0D/ge32jaq2/epig_plus_orig_marglik/active_learning_marglik/run_image_classification_40k_epig_acq.py", line 259, in <module>
    if args['use_wandb']:
  File "/dss/dsshome1/0D/ge32jaq2/epig_plus_orig_marglik/active_learning_marglik/run_image_classification_40k_epig_acq.py", line 184, in main
    print("Estimate epig using pool")
  File "/dss/dsshome1/0D/ge32jaq2/epig_plus_orig_marglik/active_learning_marglik/active_learning/active_learners.py", line 64, in fit
    la, _, margliks = marglik_optimization(
  File "/dss/dsshome1/0D/ge32jaq2/epig_plus_orig_marglik/active_learning_marglik/active_learning/marglik.py", line 293, in marglik_optimization
    marglik = -lap.log_marginal_likelihood(prior_prec, sigma_noise) / N
  File "/usr/local/lib/python3.10/dist-packages/laplace/baselaplace.py", line 528, in log_marginal_likelihood
    return self.log_likelihood - 0.5 * (self.log_det_ratio + self.scatter)
  File "/usr/local/lib/python3.10/dist-packages/laplace/baselaplace.py", line 466, in log_det_ratio
    return self.log_det_posterior_precision - self.log_det_prior_precision
  File "/usr/local/lib/python3.10/dist-packages/laplace/baselaplace.py", line 935, in log_det_posterior_precision
    return self.posterior_precision.logdet()
  File "/usr/local/lib/python3.10/dist-packages/laplace/baselaplace.py", line 929, in posterior_precision
    return self.H * self._H_factor + self.prior_precision
  File "/usr/local/lib/python3.10/dist-packages/laplace/utils/matrix.py", line 325, in __mul__
    eigenvalues = [[pow(scalar, 1/len(ls)) * l for l in ls] for ls in self.eigenvalues]
  File "/usr/local/lib/python3.10/dist-packages/laplace/utils/matrix.py", line 325, in <listcomp>
    eigenvalues = [[pow(scalar, 1/len(ls)) * l for l in ls] for ls in self.eigenvalues]
  File "/usr/local/lib/python3.10/dist-packages/laplace/utils/matrix.py", line 325, in <listcomp>
    eigenvalues = [[pow(scalar, 1/len(ls)) * l for l in ls] for ls in self.eigenvalues]
KeyboardInterrupt
Traceback (most recent call last):
  File "/dss/dsshome1/0D/ge32jaq2/epig_plus_orig_marglik/active_learning_marglik/run_image_classification_40k_epig_acq.py", line 259, in <module>
    if args['use_wandb']:
  File "/dss/dsshome1/0D/ge32jaq2/epig_plus_orig_marglik/active_learning_marglik/run_image_classification_40k_epig_acq.py", line 184, in main
    print("Estimate epig using pool")
  File "/dss/dsshome1/0D/ge32jaq2/epig_plus_orig_marglik/active_learning_marglik/active_learning/active_learners.py", line 64, in fit
    la, _, margliks = marglik_optimization(
  File "/dss/dsshome1/0D/ge32jaq2/epig_plus_orig_marglik/active_learning_marglik/active_learning/marglik.py", line 293, in marglik_optimization
    marglik = -lap.log_marginal_likelihood(prior_prec, sigma_noise) / N
  File "/usr/local/lib/python3.10/dist-packages/laplace/baselaplace.py", line 528, in log_marginal_likelihood
    return self.log_likelihood - 0.5 * (self.log_det_ratio + self.scatter)
  File "/usr/local/lib/python3.10/dist-packages/laplace/baselaplace.py", line 466, in log_det_ratio
    return self.log_det_posterior_precision - self.log_det_prior_precision
  File "/usr/local/lib/python3.10/dist-packages/laplace/baselaplace.py", line 935, in log_det_posterior_precision
    return self.posterior_precision.logdet()
  File "/usr/local/lib/python3.10/dist-packages/laplace/baselaplace.py", line 929, in posterior_precision
    return self.H * self._H_factor + self.prior_precision
  File "/usr/local/lib/python3.10/dist-packages/laplace/utils/matrix.py", line 325, in __mul__
    eigenvalues = [[pow(scalar, 1/len(ls)) * l for l in ls] for ls in self.eigenvalues]
  File "/usr/local/lib/python3.10/dist-packages/laplace/utils/matrix.py", line 325, in <listcomp>
    eigenvalues = [[pow(scalar, 1/len(ls)) * l for l in ls] for ls in self.eigenvalues]
  File "/usr/local/lib/python3.10/dist-packages/laplace/utils/matrix.py", line 325, in <listcomp>
    eigenvalues = [[pow(scalar, 1/len(ls)) * l for l in ls] for ls in self.eigenvalues]
KeyboardInterrupt