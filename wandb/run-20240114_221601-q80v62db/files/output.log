
Pool shape : torch.Size([40000, 1, 28, 28])
Starting epig acquisition
Using original estimate_epig function
[run_image_classification_40k_epig_acq.py:164]INFO: Initial test log-likelihood: -4.4428
[run_image_classification_40k_epig_acq.py:165]INFO: Initial test Bayes log-likelihood: -2.1742
[run_image_classification_40k_epig_acq.py:166]INFO: Initial accuracy: 48.72%
We are in concat
Starting epig acquisition
Using original estimate_epig function
[run_image_classification_40k_epig_acq.py:205]INFO: Test log-likelihood at 21: -4.7474
[run_image_classification_40k_epig_acq.py:206]INFO: Test Bayes log-likelihood at 21: -2.2202
[run_image_classification_40k_epig_acq.py:207]INFO: Test accuracy: 45.45%
We are in concat
[run_image_classification_40k_epig_acq.py:205]INFO: Test log-likelihood at 22: -4.8695
[run_image_classification_40k_epig_acq.py:206]INFO: Test Bayes log-likelihood at 22: -2.1864
[run_image_classification_40k_epig_acq.py:207]INFO: Test accuracy: 49.28%
Starting epig acquisition
Using original estimate_epig function
We are in concat
Starting epig acquisition
Using original estimate_epig function
[run_image_classification_40k_epig_acq.py:205]INFO: Test log-likelihood at 23: -3.4609
[run_image_classification_40k_epig_acq.py:206]INFO: Test Bayes log-likelihood at 23: -2.1877
[run_image_classification_40k_epig_acq.py:207]INFO: Test accuracy: 50.85%
We are in concat
Starting epig acquisition
Using original estimate_epig function
[run_image_classification_40k_epig_acq.py:205]INFO: Test log-likelihood at 24: -3.5023
[run_image_classification_40k_epig_acq.py:206]INFO: Test Bayes log-likelihood at 24: -2.2050
[run_image_classification_40k_epig_acq.py:207]INFO: Test accuracy: 47.78%
We are in concat
[run_image_classification_40k_epig_acq.py:205]INFO: Test log-likelihood at 25: -5.0371
[run_image_classification_40k_epig_acq.py:206]INFO: Test Bayes log-likelihood at 25: -2.3039
[run_image_classification_40k_epig_acq.py:207]INFO: Test accuracy: 50.00%
Starting epig acquisition
Using original estimate_epig function
We are in concat
[run_image_classification_40k_epig_acq.py:205]INFO: Test log-likelihood at 26: -4.5340
[run_image_classification_40k_epig_acq.py:206]INFO: Test Bayes log-likelihood at 26: -2.3162
[run_image_classification_40k_epig_acq.py:207]INFO: Test accuracy: 50.79%
Starting epig acquisition
Using original estimate_epig function
We are in concat
Traceback (most recent call last):
  File "/dss/dsshome1/0D/ge32jaq2/epig_plus_orig_marglik/active_learning_marglik/run_image_classification_40k_epig_acq.py", line 273, in <module>
    main(**args)
  File "/dss/dsshome1/0D/ge32jaq2/epig_plus_orig_marglik/active_learning_marglik/run_image_classification_40k_epig_acq.py", line 201, in main
    test_ll_bayes = learner.log_lik_bayes(test_loader)
  File "/dss/dsshome1/0D/ge32jaq2/epig_plus_orig_marglik/active_learning_marglik/active_learning/active_learners.py", line 96, in log_lik_bayes
    p = self.la(x, link_approx='mc')
  File "/usr/local/lib/python3.10/dist-packages/laplace/baselaplace.py", line 597, in __call__
    return self.predictive_samples(x, pred_type='glm', n_samples=n_samples,
  File "/usr/local/lib/python3.10/dist-packages/laplace/baselaplace.py", line 664, in predictive_samples
    f_samples = normal_samples(f_mu, f_var, n_samples, generator)
  File "/usr/local/lib/python3.10/dist-packages/laplace/utils/utils.py", line 260, in normal_samples
    scale = torch.linalg.cholesky(var)
KeyboardInterrupt
Traceback (most recent call last):
  File "/dss/dsshome1/0D/ge32jaq2/epig_plus_orig_marglik/active_learning_marglik/run_image_classification_40k_epig_acq.py", line 273, in <module>
    main(**args)
  File "/dss/dsshome1/0D/ge32jaq2/epig_plus_orig_marglik/active_learning_marglik/run_image_classification_40k_epig_acq.py", line 201, in main
    test_ll_bayes = learner.log_lik_bayes(test_loader)
  File "/dss/dsshome1/0D/ge32jaq2/epig_plus_orig_marglik/active_learning_marglik/active_learning/active_learners.py", line 96, in log_lik_bayes
    p = self.la(x, link_approx='mc')
  File "/usr/local/lib/python3.10/dist-packages/laplace/baselaplace.py", line 597, in __call__
    return self.predictive_samples(x, pred_type='glm', n_samples=n_samples,
  File "/usr/local/lib/python3.10/dist-packages/laplace/baselaplace.py", line 664, in predictive_samples
    f_samples = normal_samples(f_mu, f_var, n_samples, generator)
  File "/usr/local/lib/python3.10/dist-packages/laplace/utils/utils.py", line 260, in normal_samples
    scale = torch.linalg.cholesky(var)
KeyboardInterrupt