[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[run_image_classification.py:70]INFO: Initial test log-likelihood: -2.3026
[run_image_classification.py:71]INFO: Initial test Bayes log-likelihood: -2.3026
[run_image_classification.py:72]INFO: Initial accuracy: 11.35%
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[utils.py:157]INFO: SYMEIG: adding jitter, did not converge.
[run_image_classification.py:92]INFO: Test log-likelihood at 21: -2.3026
[run_image_classification.py:93]INFO: Test Bayes log-likelihood at 21: -2.3026
[run_image_classification.py:94]INFO: Test accuracy: 9.58%
[run_image_classification.py:92]INFO: Test log-likelihood at 22: -2.2616
[run_image_classification.py:93]INFO: Test Bayes log-likelihood at 22: -2.2664
[run_image_classification.py:94]INFO: Test accuracy: 19.99%
Traceback (most recent call last):
  File "/dss/dsshome1/0D/ge32jaq2/active_learning_marglik/active_learning/active_learners.py", line 124, in bald
    p_samples = self.la.predictive_samples(x, n_samples=150)
  File "/usr/local/lib/python3.10/dist-packages/laplace/baselaplace.py", line 585, in predictive_samples
    dist = MultivariateNormal(f_mu, f_var)
  File "/usr/local/lib/python3.10/dist-packages/torch/distributions/multivariate_normal.py", line 177, in __init__
    super().__init__(batch_shape, event_shape, validate_args=validate_args)
  File "/usr/local/lib/python3.10/dist-packages/torch/distributions/distribution.py", line 68, in __init__
    raise ValueError(
ValueError: Expected parameter covariance_matrix (Tensor of shape (500, 10, 10)) of distribution MultivariateNormal(loc: torch.Size([500, 10]), covariance_matrix: torch.Size([500, 10, 10])) to satisfy the constraint PositiveDefinite(), but found invalid values:
tensor([[[ 0.2201, -0.1857,  0.1074,  ..., -0.0913,  0.0586, -0.1203],
         [-0.1857,  0.2696, -0.1197,  ...,  0.1059, -0.0645,  0.1395],
         [ 0.1074, -0.1197,  0.1248,  ..., -0.0583,  0.0387, -0.0778],
         ...,
         [-0.0913,  0.1059, -0.0583,  ...,  0.1110, -0.0287,  0.0668],
         [ 0.0586, -0.0645,  0.0387,  ..., -0.0287,  0.0795, -0.0446],
         [-0.1203,  0.1395, -0.0778,  ...,  0.0668, -0.0446,  0.1501]],
        [[ 0.4099, -0.3286,  0.1909,  ..., -0.1632,  0.1023, -0.2106],
         [-0.3287,  0.4980, -0.2113,  ...,  0.1905, -0.1111,  0.2450],
         [ 0.1909, -0.2113,  0.2405,  ..., -0.1041,  0.0674, -0.1355],
         ...,
         [-0.1632,  0.1904, -0.1041,  ...,  0.2177, -0.0513,  0.1206],
         [ 0.1023, -0.1111,  0.0674,  ..., -0.0513,  0.1572, -0.0741],
         [-0.2106,  0.2450, -0.1355,  ...,  0.1207, -0.0740,  0.2808]],
        [[ 0.1748, -0.1663,  0.0957,  ..., -0.0802,  0.0540, -0.1100],
         [-0.1664,  0.2190, -0.1077,  ...,  0.0925, -0.0603,  0.1266],
         [ 0.0957, -0.1076,  0.0899,  ..., -0.0516,  0.0354, -0.0713],
         ...,
         [-0.0802,  0.0925, -0.0516,  ...,  0.0742, -0.0277,  0.0604],
         [ 0.0540, -0.0603,  0.0354,  ..., -0.0277,  0.0491, -0.0410],
         [-0.1100,  0.1266, -0.0713,  ...,  0.0604, -0.0410,  0.1136]],
        ...,
        [[ 0.1346, -0.1204,  0.0693,  ..., -0.0572,  0.0400, -0.0806],
         [-0.1205,  0.1669, -0.0781,  ...,  0.0659, -0.0449,  0.0929],
         [ 0.0693, -0.0781,  0.0734,  ..., -0.0368,  0.0264, -0.0525],
         ...,
         [-0.0572,  0.0659, -0.0368,  ...,  0.0619, -0.0192,  0.0425],
         [ 0.0400, -0.0449,  0.0264,  ..., -0.0192,  0.0457, -0.0321],
         [-0.0806,  0.0929, -0.0525,  ...,  0.0425, -0.0321,  0.0933]],
        [[ 0.1611, -0.1308,  0.0759,  ..., -0.0647,  0.0409, -0.0841],
         [-0.1308,  0.1961, -0.0841,  ...,  0.0754, -0.0446,  0.0978],
         [ 0.0759, -0.0841,  0.0938,  ..., -0.0413,  0.0270, -0.0542],
         ...,
         [-0.0647,  0.0754, -0.0413,  ...,  0.0846, -0.0202,  0.0476],
         [ 0.0409, -0.0446,  0.0270,  ..., -0.0202,  0.0612, -0.0302],
         [-0.0841,  0.0978, -0.0542,  ...,  0.0476, -0.0302,  0.1106]],
        [[ 0.1475, -0.1202,  0.0695,  ..., -0.0570,  0.0402, -0.0805],
         [-0.1202,  0.1799, -0.0779,  ...,  0.0659, -0.0449,  0.0933],
         [ 0.0695, -0.0779,  0.0864,  ..., -0.0365,  0.0267, -0.0525],
         ...,
         [-0.0570,  0.0659, -0.0365,  ...,  0.0754, -0.0184,  0.0419],
         [ 0.0402, -0.0449,  0.0267,  ..., -0.0184,  0.0596, -0.0330],
         [-0.0805,  0.0933, -0.0525,  ...,  0.0419, -0.0330,  0.1074]]],
       device='cuda:0')
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/dss/dsshome1/0D/ge32jaq2/active_learning_marglik/run_image_classification.py", line 157, in <module>
    main(**args)
  File "/dss/dsshome1/0D/ge32jaq2/active_learning_marglik/run_image_classification.py", line 81, in main
    bald_scores = learner.bald(dataset.get_pool_loader(batch_size=batch_size))
  File "/dss/dsshome1/0D/ge32jaq2/active_learning_marglik/active_learning/active_learners.py", line 126, in bald
    p_samples = self.la.predictive_samples(x, n_samples=150, diagonal_output = True)
TypeError: ParametricLaplace.predictive_samples() got an unexpected keyword argument 'diagonal_output'